# CubeGPT: A Transformer-based Rubik's Cube Solver

## Problem: The 3x3 Rubik's Cube
The Rubik's Cube presents an interesting challenge for search algorithms. With roughly 4 * 10<sup>19</sup> possible states but only one destination, traditional algorithms that tend to explore a large fraction of state space (like breadth first search, or even A*) are not practically applicable. We have to prune our decision trees *extremely* aggressively  if we want to solve Cubes in a realistic amount of time. This begs a highly effective heuristic function, which is where machine learning comes in. 


![A scrambled Rubik's Cube with an arrow pointing to a solved Rubik's Cube](images/scrambledArrowSolved.png)

This project is inspired by the CayleyPy, EfficientCube, and DeepCubeA papers.

## Approach

### Neural Network 
We train a transformer neural network to predict the number of moves required to solve a Rubik's Cube, a sense of 'distance' from the solved state. This neural network will serve as our heuristic function. The hyperparameters were selected by experimental performance after being trained on 3.84M examples. 

### Training
Training data is generated by taking random walks from the starting state, with some optimizations to help prevent backtracking. The random walk distance serves as an estimator for the true distance from the solved state. Since shorter paths are more likely to hit any given state than longer paths (because longer paths may access many more states), theoretically the minimum length path will dominate.

We empirically show that training first on individual random samples (the 'ends' of the random walks) then finetuning on entire random walks allows these models to achieve minimum loss and generally maximum accuracy metrics, with  statistical significance. I refer to this method as "Path Finetuning."

### Solving

Solving is done via beam search: every step, we project forward one move, then evaluate each of those new states using the model. All but the lowest *w* are pruned. For solving fully scrambled cubes, we find highly consistent success with *w* = 4000. Increasing *w* generally increases the solve probability and decreases the lengths of the found solutions. 